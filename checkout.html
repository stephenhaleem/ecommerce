<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Checkout - MyStore</title>
    <link rel="stylesheet" href="css/styles.css">
</head>
<body>
    <!-- Navigation -->
    <nav>
        <div class="logo">MyStore</div>
        <ul class="nav-links">
            <li><a href="index.html">Home</a></li>
            <li><a href="cart.html">Cart (<span id="cart-count">0</span>)</a></li>
            <li><a href="orders.html">My Orders</a></li>
            <li><a href="#" id="auth-link">Login</a></li>
        </ul>
    </nav>

    <!-- Main Content -->
    <main>
        <div class="checkout-container">
            <h2>Checkout</h2>
            
            <!-- Order Summary -->
            <div class="order-summary">
                <h3>Order Summary</h3>
                <div id="checkout-items">
                    <!-- Items will be loaded here -->
                </div>
                <div class="total-section">
                    <h3>Total: ₦<span id="checkout-total">0.00</span></h3>
                </div>
            </div>

            <!-- Payment Method Selection -->
            <div class="payment-section">
                <h3>Select Payment Method</h3>
                
                <div class="payment-options">
                    <button onclick="initiatePaystackPayment()" class="btn-payment">
                        Pay with Paystack
                    </button>
                    
                    <button onclick="initiateFlutterwavePayment()" class="btn-payment">
                        Pay with Flutterwave
                    </button>
                </div>

                <p class="payment-note">
                    You will be redirected to a secure payment page
                </p>
            </div>
        </div>
    </main>

    <!-- Footer -->
    <footer>
        <p>&copy; 2024 MyStore. All rights reserved.</p>
    </footer>

    <!-- Payment Gateway Scripts -->
    <script src="https://js.paystack.co/v1/inline.js"></script>
    <script src="https://checkout.flutterwave.com/v3.js"></script>
    
    <!-- App Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="js/config.js"></script>
    <script src="js/auth.js"></script>
    <script src="js/cart.js"></script>
    <script src="js/payment.js"></script>
    
    <script>
        // Display checkout summary when page loads
        function displayCheckoutSummary() {
            const cart = getCart();
            const container = document.getElementById('checkout-items');
            
            if (cart.length === 0) {
                container.innerHTML = '<p>Your cart is empty</p>';
                document.getElementById('checkout-total').textContent = '0.00';
                return;
            }
            
            let html = '';
            cart.forEach(item => {
                html += `
                    <div class="checkout-item">
                        <span>${item.name} x ${item.quantity}</span>
                        <span>₦${(item.price * item.quantity).toFixed(2)}</span>
                    </div>
                `;
            });
            
            container.innerHTML = html;
            document.getElementById('checkout-total').textContent = calculateTotal().toFixed(2);
        }
        
        displayCheckoutSummary();
    </script>
</body>
</html>